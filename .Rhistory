theme(legend.position = "none")
p3
theme(legend.position = "none")
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey", alpha = 0.5)+
geom_point(data = sumRef, aes(x = 20, y = meanRich), size = 2, colour = c("blue","red"))+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
facet_wrap(~ tempSeq)+
theme_bw()+
theme(legend.position = "none")
p3
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey", alpha = 0.5)+
geom_point(data = sumRef, aes(x = 20, y = meanRich, col = meanRich), size = 2)+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
facet_wrap(~ tempSeq)+
theme_bw()+
theme(legend.position = "none")
p3
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey", alpha = 0.5)+
geom_point(data = sumRef, aes(x = 20, y = meanRich, col = factor(meanRich)), size = 2)+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
facet_wrap(~ tempSeq)+
theme_bw()+
theme(legend.position = "none")
p3
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
# add mean + CI ribbon
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanRich, col = factor(meanRich)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
# facet by sequence
facet_wrap(~ tempSeq)+
# theming
theme_bw()+
theme(legend.position = "none")
p3
factor(meanRich)
Season30 <- read_csv("tempSeason30.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
Season40 <- read_csv("tempSeason30.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
# add mean + CI ribbon
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanRich, col = factor(meanRich)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
# facet by sequence
facet_wrap(~ tempSeq)+
# theming
theme_bw()+
theme(legend.position = "none")
sumT <- df %>%
group_by(tempSeq, step) %>%
summarise(
meanRichness = mean(richness),
seRichness = 1.96*(sd(richness)/sqrt(n())),
meanBiomass = mean(biomass),
seBiomass = 1.96*(sd(biomass)/sqrt(n()))
)
# reference
ref_df <- bind_rows(fix20, fix40) %>%
mutate(fixedTemp = rep(c(20,40), each = 10)) # nwebs
p1 <- ggplot(ref_df, aes(x = temp, y = richness, group = temp))+
geom_boxplot()
p2 <- ggplot(ref_df, aes(x = temp, y = biomass, group = temp))+
geom_boxplot()
p1+p2
sumRef <- ref_df %>%
group_by(temp) %>%
summarise(
meanRich = mean(richness),
meanBiomass = mean(biomass)
)
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
# add mean + CI ribbon
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanRich, col = factor(meanRich)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
# facet by sequence
facet_wrap(~ tempSeq)+
# theming
theme_bw()+
theme(legend.position = "none")
p3
p3+p1
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, group = temp))+
geom_boxplot()
p1
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, group = temp))+
geom_boxplot()+
scale_fill_manual(values = c(20 = "blue", 40 = "red"))
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, group = temp))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))
p2 <- ggplot(ref_df, aes(x = temp, y = biomass, group = temp))+
geom_boxplot()
p1+p2
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, colour = temp))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))
p2 <- ggplot(ref_df, aes(x = temp, y = biomass, group = temp))+
geom_boxplot()
p1+p2
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, fill = temp))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))
p2 <- ggplot(ref_df, aes(x = temp, y = biomass, group = temp))+
geom_boxplot()
p1+p2
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))
p2 <- ggplot(ref_df, aes(x = temp, y = biomass, group = temp))+
geom_boxplot()
p1+p2
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))+
theme_bw()+
theme(legend.position = "none")
p2 <- ggplot(ref_df, aes(x = temp, y = biomass, group = temp))+
geom_boxplot()
p1+p2
p2 <- ggplot(ref_df, aes(x = temp, y = biomass, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))+
theme_bw()+
theme(legend.position = "none")
p1+p2
p2 <- ggplot(ref_df, aes(x = factor(temp), y = biomass, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))+
theme_bw()+
theme(legend.position = "none")
p1+p2
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
# add mean + CI ribbon
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey80", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanRich, col = factor(meanRich)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
# facet by sequence
facet_wrap(~ tempSeq)+
# theming
theme_bw()+
theme(legend.position = "none")
p3+p1
# Season + Linear
LinSeason <- read_csv("tempLinSeason.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
LinSeason
p4 <- ggplot(df, aes(x = step, y = biomass, col = fw))+
geom_point()+
geom_line()+
geom_line(data = sumT, aes(x = step, y = meanBiomass), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanBiomass,
ymax = meanBiomass+seBiomass,
ymin = meanBiomass-seBiomass), col = "grey80", alpha = 0.5)+
facet_wrap(~ tempSeq)+
theme_bw()+
theme(legend.position = "none")
p4+p2
p4 <- ggplot(df, aes(x = step, y = biomass, col = fw))+
geom_point()+
geom_line()+
geom_line(data = sumT, aes(x = step, y = meanBiomass), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanBiomass,
ymax = meanBiomass+seBiomass,
ymin = meanBiomass-seBiomass), col = "grey80", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanBiomass, col = factor(meanBiomass)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanBiomass), linetype = 'dashed')+
facet_wrap(~ tempSeq)+
theme_bw()+
theme(legend.position = "none")
p4+p2
library(tidyverse)
library(patchwork)
xx <- read_csv("temLinVar.csv")
xx
xx <- read_tibble("temLinVar.csv")
xx <- read_csv("tempLinVar.csv")
xx
# Lin + Variation
LinVar <- read_csv("tempLinVar.csv")
# Lin + Variation
LinVar <- read_csv("tempLinVar.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15) %>%
mutate(replicate = rep(1:10, each = 200))
LinVar
ggplot(LinVar, aes(x=step, y = biomass, colour = fw))+
geom_point()+ facet_wrap(~replicate)
# Lin + Variation
LinVar <- read_csv("tempLinVar.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15) %>%
mutate(replicate = rep(1:10, each = 200))
ggplot(LinVar, aes(x=step, y = biomass, colour = fw))+
geom_point()+ facet_wrap(~replicate)
sumT_vars <- LinVar %>%
group_by(replicate, step) %>%
summarise(meanRichness = mean(Richness),
meanBiomass = mean(Biomass))
sumT_vars <- LinVar %>%
group_by(replicate, step) %>%
summarise(meanRichness = mean(richness),
meanBiomass = mean(biomass))
sumT_vars
p5 <- ggplot(sumT_vars, aes(x = step, y = biomass, colour = replicate))+
geom_line()
p5
p5 <- ggplot(sumT_vars, aes(x = step, y = meanBiomass, colour = replicate))+
geom_line()
p5
geom_line()
p5 <- ggplot(sumT_vars, aes(x = step, y = meanBiomass, colour = factor(replicate))+
p5 <- ggplot(sumT_vars, aes(x = step, y = meanBiomass, colour = factor(replicate)))+
geom_line()
p5
p5 <- ggplot(sumT_vars, aes(x = step, y = meanBiomass, colour = factor(replicate)))+
geom_line()
p5
p6 <- ggplot(sumT_vars, aes(x = step, y = meanRichness, colour = factor(replicate)))+
geom_line()
p5+p6
p5 <- ggplot(sumT_vars, aes(x = step, y = meanBiomass, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p6 <- ggplot(sumT_vars, aes(x = step, y = meanRichness, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p5+p6
LinVarSeason <- read_csv("tempLinVarSeason.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15) %>%
mutate(replicate = rep(1:10, each = 200))
library(tidyverse)
library(patchwork)
LinVarSeason <- read_csv("tempLinVarSeason.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15) %>%
mutate(replicate = rep(1:10, each = 200))
## summarise random var+Season data to have single mean among 10 webs per random run ----
sumT_varsSeason <- LinVarSeason %>%
group_by(replicate, step) %>%
summarise(meanRichness = mean(richness),
meanBiomass = mean(biomass))
p7 <- ggplot(sumT_varsSeason, aes(x = step, y = meanBiomass, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p8 <- ggplot(sumT_varsSeason, aes(x = step, y = meanRichness, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p7+p8
(p1+p2+p3+p4)/(p5+p6+p7+p8)
library(tidyverse)
library(patchwork)
# Data Sets ----------------------------------------
## reference 20/40 ----
fix20 <- read_csv("temp20Cons") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
fix40 <- read_csv("temp40Cons") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
## Lin is linear change ----
Lin <- read_csv("tempLinRun.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
## Seasonal change at 20, 30, 40 ----
Season20 <- read_csv("tempSeason20.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
Season30 <- read_csv("tempSeason30.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
Season40 <- read_csv("tempSeason30.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
## Season + Linear ----
LinSeason <- read_csv("tempLinSeason.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15)
## Lin + Variation ----
LinVar <- read_csv("tempLinVar.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15) %>%
mutate(replicate = rep(1:10, each = 200))
## Lin + Season + Variation ----
LinVarSeason <- read_csv("tempLinVarSeason.csv") %>%
mutate(fw = factor(fw)) %>%
mutate(temp = temp - 273.15) %>%
mutate(replicate = rep(1:10, each = 200))
## Combine all without variation ----
df <- bind_rows(Lin, Season20, Season30, Season40, LinSeason) %>%
mutate(tempSeq = rep(c("Lin",
"Season20", "Season30", "Season40",
"LinSeason"),
each = 200))
# summarise ------------------------------------------
# note use of step rather than temperature as x-axis
# for linear it is 20 -> 40
# for season it is 21.5 -> 19.5 repeated for 10 cycles
## summarise all with non var to mean from among n networks ----
sumT <- df %>%
group_by(tempSeq, step) %>%
summarise(
meanRichness = mean(richness),
seRichness = 1.96*(sd(richness)/sqrt(n())),
meanBiomass = mean(biomass),
seBiomass = 1.96*(sd(biomass)/sqrt(n()))
)
## summarise random var data to have single mean among 10 webs per random run ----
sumT_vars <- LinVar %>%
group_by(replicate, step) %>%
summarise(meanRichness = mean(richness),
meanBiomass = mean(biomass))
## summarise random var+Season data to have single mean among 10 webs per random run ----
sumT_varsSeason <- LinVarSeason %>%
group_by(replicate, step) %>%
summarise(meanRichness = mean(richness),
meanBiomass = mean(biomass))
# plots, faceted by tempSeq type. -------------------------------
## reference plot ----
ref_df <- bind_rows(fix20, fix40) %>%
mutate(fixedTemp = rep(c(20,40), each = 10)) # nwebs
p1 <- ggplot(ref_df, aes(x = factor(temp), y = richness, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))+
theme_bw()+
theme(legend.position = "none")
p2 <- ggplot(ref_df, aes(x = factor(temp), y = biomass, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))+
theme_bw()+
theme(legend.position = "none")
p1+p2
## reference data to annotate sequence plots ----
sumRef <- ref_df %>%
group_by(temp) %>%
summarise(
meanRich = mean(richness),
meanBiomass = mean(biomass)
)
# temperature sequeucen treatment plots ----
p3 <- ggplot(df, aes(x = step, y = richness, col = fw))+
geom_point()+
geom_line()+
# add mean + CI ribbon
geom_line(data = sumT, aes(x = step, y = meanRichness), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanRichness,
ymax = meanRichness+seRichness,
ymin = meanRichness-seRichness), col = "grey80", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanRich, col = factor(meanRich)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanRich), linetype = 'dashed')+
# facet by sequence
facet_wrap(~ tempSeq)+
# theming
theme_bw()+
theme(legend.position = "none")
p3+p1
p4 <- ggplot(df, aes(x = step, y = biomass, col = fw))+
geom_point()+
geom_line()+
geom_line(data = sumT, aes(x = step, y = meanBiomass), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanBiomass,
ymax = meanBiomass+seBiomass,
ymin = meanBiomass-seBiomass), col = "grey80", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanBiomass, col = factor(meanBiomass)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanBiomass), linetype = 'dashed')+
facet_wrap(~ tempSeq)+
theme_bw()+
theme(legend.position = "none")
p4+p2
## Temp Seq Plots with stoch, so each line is a unique set of randomness ----
p5 <- ggplot(sumT_vars, aes(x = step, y = meanBiomass, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p6 <- ggplot(sumT_vars, aes(x = step, y = meanRichness, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p5+p6
## Temp Seq Plots with Season and stoch, so each line is a unique set of randomness ----
p7 <- ggplot(sumT_varsSeason, aes(x = step, y = meanBiomass, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p8 <- ggplot(sumT_varsSeason, aes(x = step, y = meanRichness, colour = factor(replicate)))+
geom_line()+
theme_bw()+
theme(legend.position = "none")
p7+p8
(p1+p2+p3+p4)/(p5+p6+p7+p8)
# ALL In
(p1/p2/p3/p4)+(p5/p6/p7/p8)
(p1+p2+p3+p4)
?patchwork
(p1|p2|p3|p4)
# ALL In
(p1|p2|p3|p4)/(p5|p6|p7|p8)
p3 <- ggplot(df, aes(x = step, y = biomass, col = fw))+
geom_point()+
geom_line()+
geom_line(data = sumT, aes(x = step, y = meanBiomass), col = "black")+
geom_ribbon(data = sumT, aes(x = step, y = meanBiomass,
ymax = meanBiomass+seBiomass,
ymin = meanBiomass-seBiomass), col = "grey80", alpha = 0.5)+
# add constant (single temp) means
# need to adjust just these colours
geom_point(data = sumRef, aes(x = 20, y = meanBiomass, col = factor(meanBiomass)), size = 5)+
geom_hline(data = sumRef, aes(yintercept = meanBiomass), linetype = 'dashed')+
facet_wrap(~ tempSeq)+
theme_bw()+
theme(legend.position = "none")
p3+p2
p1 <- ggplot(ref_df, aes(x = factor(temp), y = biomass, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))+
theme_bw()+
theme(legend.position = "none")
p2 <- ggplot(ref_df, aes(x = factor(temp), y = richness, fill = factor(temp)))+
geom_boxplot()+
scale_fill_manual(values = c("20" = "blue", "40" = "red"))+
theme_bw()+
theme(legend.position = "none")
p1+p2
# ALL In
(p1|p2|p3|p4)/(p5|p6|p7|p8)
sumRef
df
Lin
seq20_step1 <- Lin %>%
filter(temp == 20)
seq20_step1
sumT
sumT %>% filter(step == 1)
seq20_step1 <- Lin %>%
filter(temp == 20) %>%
summarise(meanRichness = mean(richness))
seq20_step1
sumT %>% filter(step == 1)
sumT %>% filter(step == 1 & tempSeq == "Lin")
seq20_step1 <- Lin %>%
filter(temp == 20) %>%
summarise(meanRichness = mean(richness),
meanBiomass = mean(biomass))
seq20_step1
sumT %>% filter(step == 1 & tempSeq == "Lin")
sumT %>% filter(step == 1 & tempSeq == "Lin") %>%
select(meanRichness, meanBiomass)
seq20_step1
sumT %>% filter(step == 1 & tempSeq == "Lin") %>%
select(meanRichness, meanBiomass)
